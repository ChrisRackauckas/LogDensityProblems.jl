<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Overview · LogDensityProblems.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>LogDensityProblems.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Overview</a><ul class="internal"><li><a class="toctext" href="#Introduction-1">Introduction</a></li><li><a class="toctext" href="#Problem-definition-1">Problem definition</a></li><li><a class="toctext" href="#Gradient-via-automatic-differentiation-1">Gradient via automatic differentiation</a></li><li><a class="toctext" href="#Inference-1">Inference</a></li><li><a class="toctext" href="#Benchmarking,-diagnostics,-and-utilities-1">Benchmarking, diagnostics, and utilities</a></li><li><a class="toctext" href="#Internals-1">Internals</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Overview</a></li></ul><a class="edit-page" href="https://github.com/tpapp/LogDensityProblems.jl/blob/master/docs/src/index.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Overview</span><a class="fa fa-bars" href="#"></a></div></header><h2><a class="nav-anchor" id="Introduction-1" href="#Introduction-1">Introduction</a></h2><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>Currently this is just a placeholder that renders the docstrings.</p></div></div><h2><a class="nav-anchor" id="Problem-definition-1" href="#Problem-definition-1">Problem definition</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.TransformedLogDensity" href="#LogDensityProblems.TransformedLogDensity"><code>LogDensityProblems.TransformedLogDensity</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">TransformedLogDensity(transformation, log_density_function)</code></pre><p>A problem in Bayesian inference. Vectors of length <code>dimension(transformation)</code> are transformed into a general object <code>θ</code> (unrestricted type, but a named tuple is recommended for clean code), correcting for the log Jacobian determinant of the transformation.</p><p>It is recommended that <code>log_density_function</code> is a callable object that also encapsulates the data for the problem.</p><p><code>log_density_function(θ)</code> is expected to return <em>real numbers</em>. For zero densities or infeasible <code>θ</code>s, <code>-Inf</code> or similar should be returned, but for efficiency of inference most methods recommend using <code>transformation</code> to avoid this.</p><p>Use the property accessors <code>ℓ.transformation</code> and <code>ℓ.log_density_function</code> to access the arguments of <code>ℓ::TransformedLogDensity</code>, these are part of the API.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/transformed.jl#L7-L23">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.reject_logdensity" href="#LogDensityProblems.reject_logdensity"><code>LogDensityProblems.reject_logdensity</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">reject_logdensity()
</code></pre><p>Make wrappers return a <code>-Inf</code> log density (of the appropriate type).</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>This is done by throwing an exception that is caught by the wrappers, unwinding the stack. Using this function or returning <code>-Inf</code> is an implementation choice, do whatever is most convenient.</p></div></div></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/rejection.jl#L12">source</a></section><h2><a class="nav-anchor" id="Gradient-via-automatic-differentiation-1" href="#Gradient-via-automatic-differentiation-1">Gradient via automatic differentiation</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.ADgradient" href="#LogDensityProblems.ADgradient"><code>LogDensityProblems.ADgradient</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">ADgradient(kind, P; kwargs...)
</code></pre><p>Wrap <code>P</code> using automatic differentiation to obtain a gradient.</p><p><code>kind</code> is usually a <code>Val</code> type, containing a symbol that refers to a package. The symbol can also be used directly as eg</p><pre><code class="language-julia">ADgradient(:ForwardDiff, P)</code></pre><p>See <code>methods(ADgradient)</code>. Note that some methods are defined conditionally on the relevant package being loaded.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/AD.jl#L27">source</a><div><div><pre><code class="language-julia">ADgradient(#temp#, ℓ; chunk, gradientconfig)
</code></pre><p>Wrap a log density that supports evaluation of <code>Value</code> to handle <code>ValueGradient</code>, using <code>ForwardDiff</code>.</p><p>Keywords are passed on to <code>ForwardDiff.GradientConfig</code> to customize the setup. In particular, chunk size can be set with a <code>chunk</code> keyword argument (accepting an integer or a <code>ForwardDiff.Chunk</code>).</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/AD_ForwardDiff.jl#L24">source</a><div><div><pre><code class="language-julia">ADgradient(?, ℓ)
</code></pre><p>Gradient using algorithmic/automatic differentiation via Flux.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/AD_Flux.jl#L7">source</a></section><h2><a class="nav-anchor" id="Inference-1" href="#Inference-1">Inference</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.logdensity" href="#LogDensityProblems.logdensity"><code>LogDensityProblems.logdensity</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">logdensity(resulttype, ℓ, x)</code></pre><p>Evaluate the <a href="#LogDensityProblems.AbstractLogDensityProblem"><code>AbstractLogDensityProblem</code></a> <code>ℓ</code> at <code>x</code>, which has length compatible with its <a href="#TransformVariables.dimension"><code>dimension</code></a>.</p><p>The argument <code>resulttype</code> determines the type of the result:</p><ol><li><a href="@ref"><code>Real</code></a> for an unchecked evaluation of the log density which should return a</li></ol><p><code>::Real</code> number (that could be <code>NaN</code>, <code>Inf</code>, etc),</p><ol><li><p><a href="#LogDensityProblems.Value"><code>Value</code></a> for a checked log density, returning a <code>Value</code>,</p></li><li><p><a href="#LogDensityProblems.ValueGradient"><code>ValueGradient</code></a> also calculates the gradient, returning a <code>ValueGradient</code>,</p></li><li><p><a href="@ref"><code>ValueGradientBuffer</code></a> calculates a <code>ValueGradient</code> <em>potentially</em> (but always</p></li></ol><p>consistently for argument types) using the provided buffer for the gradient. In this case, the element type of the array may determine the result element type.</p><p><strong>Implementation note</strong></p><p>Most types should just define the methods for <code>Real</code> and <code>ValueGradientBuffer</code> (when applicable), as <code>Value</code> and <code>ValueGradient</code> fall back to these, respectively.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/problem.jl#L19-L42">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.dimension" href="#TransformVariables.dimension"><code>TransformVariables.dimension</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">dimension(p)
</code></pre><p>The dimension of the problem, ie the length of the vectors in its domain.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/transformed.jl#L33">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.Value" href="#LogDensityProblems.Value"><code>LogDensityProblems.Value</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">Value(value)
</code></pre><p>Holds the value of a logdensity at a given point.</p><p>Constructor ensures that the value is either finite, or <span>$-∞$</span>.</p><p>All other values (eg <code>NaN</code> or <code>Inf</code> for the <code>value</code>) lead to an error.</p><p>See also <a href="#LogDensityProblems.logdensity"><code>logdensity</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/result_types.jl#L37">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.ValueGradient" href="#LogDensityProblems.ValueGradient"><code>LogDensityProblems.ValueGradient</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">ValueGradient(value, gradient)
</code></pre><p>Holds the value and gradient of a logdensity at a given point.</p><p>Constructor ensures that either</p><ol><li><p>both the value and the gradient are finite,</p></li><li><p>the value is <span>$-∞$</span> (then gradient is not checked).</p></li></ol><p>All other values (eg <code>NaN</code> or <code>Inf</code> for the <code>value</code>) lead to an error.</p><p>See also <a href="#LogDensityProblems.logdensity"><code>logdensity</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/result_types.jl#L68">source</a></section><h2><a class="nav-anchor" id="Benchmarking,-diagnostics,-and-utilities-1" href="#Benchmarking,-diagnostics,-and-utilities-1">Benchmarking, diagnostics, and utilities</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.stresstest" href="#LogDensityProblems.stresstest"><code>LogDensityProblems.stresstest</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">stresstest(ℓ; N, rng, scale, resulttype)
</code></pre><p>Test <code>ℓ</code> with random values.</p><p><code>N</code> random vectors are drawn from a standard multivariate Cauchy distribution, scaled with <code>scale</code> (which can be a scalar or a conformable vector). In case the call produces an error, the value is recorded as a failure, which are returned by the function.</p><p>Not exported, but part of the API.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/stresstest.jl#L7">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.benchmark_ForwardDiff_chunks" href="#LogDensityProblems.benchmark_ForwardDiff_chunks"><code>LogDensityProblems.benchmark_ForwardDiff_chunks</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">benchmark_ForwardDiff_chunks(ℓ; chunks, resulttype, markprogress)
</code></pre><p>Benchmark a log density problem with various chunk sizes using ForwardDiff.</p><p><code>chunks</code>, which defaults to all possible chunk sizes, determines the chunks that are tried.</p><p>The function returns <code>chunk =&gt; time</code> pairs, where <code>time</code> is the benchmarked runtime in seconds, as determined by <code>BenchmarkTools.@belapsed</code>.</p><p><em>Runtime may be long</em> because of tuned benchmarks, so when <code>markprogress == true</code> (the  default), dots are printed to mark progress.</p><p>This function is not exported, but part of the API.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/AD_ForwardDiff.jl#L61">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.@iffinite" href="#LogDensityProblems.@iffinite"><code>LogDensityProblems.@iffinite</code></a> — <span class="docstring-category">Macro</span>.</div><div><div><p>If <code>expr</code> evaluates to a non-finite value, <code>return</code> with that, otherwise evaluate to that value. Useful for returning early from non-finite likelihoods.</p><p>Part of the API, but not exported.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/result_types.jl#L131">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.LogDensityRejectErrors" href="#LogDensityProblems.LogDensityRejectErrors"><code>LogDensityProblems.LogDensityRejectErrors</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">LogDensityRejectErrors(ℓ)
</code></pre><p>Wrap a logdensity <code>ℓ</code> so that errors <code>&lt;: E</code> are caught and replaced with a <span>$-∞$</span> value.</p><p><code>E</code> defaults to <code>InvalidLogDensityExceptions</code>.</p><p><strong>Note</strong></p><p>Use cautiously, as catching errors can mask errors in your code. The recommended use case is for catching quirks and corner cases of AD. See also <a href="#LogDensityProblems.stresstest"><code>stresstest</code></a> as an alternative to using this wrapper.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/reject_errors.jl#L11">source</a></section><h2><a class="nav-anchor" id="Internals-1" href="#Internals-1">Internals</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.AbstractLogDensityProblem" href="#LogDensityProblems.AbstractLogDensityProblem"><code>LogDensityProblems.AbstractLogDensityProblem</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Abstract type for log density representations, which support the following interface for <code>ℓ::AbstractLogDensityProblem</code>:</p><ol><li><p><a href="#TransformVariables.dimension"><code>dimension</code></a> returns the <em>dimension</em> of the domain of <code>ℓ</code>,</p></li><li><p><a href="#LogDensityProblems.logdensity"><code>logdensity</code></a> evaluates the log density <code>ℓ</code> at a given point.</p></li></ol><p>See also <a href="#LogDensityProblems.stresstest"><code>LogDensityProblems.stresstest</code></a> for stress testing.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/problem.jl#L7-L16">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.LogDensityWrapper" href="#LogDensityProblems.LogDensityWrapper"><code>LogDensityProblems.LogDensityWrapper</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>An abstract type that wraps another log density in its field <code>ℓ</code>.</p><p><strong>Notes</strong></p><p>Implementation detail, <em>not exported</em>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/problem.jl#L54-L60">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.ADGradientWrapper" href="#LogDensityProblems.ADGradientWrapper"><code>LogDensityProblems.ADGradientWrapper</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>An abstract type that wraps another log density for calculating the gradient via AD.</p><p>Automatically defines a <code>logdensity(Value, ...)</code> method, subtypes should define a <code>logdensity(ValueGradient, ...)</code> one.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/AD.jl#L7-L12">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.heuristic_chunks" href="#LogDensityProblems.heuristic_chunks"><code>LogDensityProblems.heuristic_chunks</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">heuristic_chunks(N)
heuristic_chunks(N, M)
</code></pre><p>Default chunk sizes to try for benchmarking. Fewer than <code>M</code>, always contains <code>1</code> and <code>N</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/AD_ForwardDiff.jl#L47">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LogDensityProblems.RejectLogDensity" href="#LogDensityProblems.RejectLogDensity"><code>LogDensityProblems.RejectLogDensity</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">struct RejectLogDensity &lt;: Exception</code></pre><p>Exception for unwinding the stack early for infeasible values. Use <code>reject_logdensity()</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/LogDensityProblems.jl/blob/869da68aaacf0e4064aecc9247212789b0ce0415/src/rejection.jl#L5">source</a></section><footer><hr/></footer></article></body></html>
